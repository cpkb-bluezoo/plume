<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self' ipc: tauri:; img-src 'self' https: data:; media-src 'self' https:; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline'; connect-src 'self' ipc: tauri: https:">
    <title>Plume - Nostr Client</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" type="image/svg+xml" href="plume.svg">
</head>
<body>
    <div id="app">
        <!-- Header -->
        <header id="header">
            <div class="header-left">
                <img src="plume.svg" alt="Plume" class="logo-icon">
                <h1>Plume</h1>
            </div>
            <div class="header-right">
                <span id="connection-status" class="status disconnected">Disconnected</span>
                <button id="settings-btn" class="icon-btn" title="Settings">‚öôÔ∏è</button>
            </div>
        </header>

        <!-- Main content area -->
        <main id="main">
            <!-- Sidebar with navigation -->
            <nav id="sidebar">
                <ul class="nav-list">
                    <li><a href="#" class="nav-item active" data-view="feed">üì∞ Feed</a></li>
                    <li><a href="#" class="nav-item" data-view="profile">üë§ Profile</a></li>
                    <li><a href="#" class="nav-item" data-view="following">üë• Following</a></li>
                    <li><a href="#" class="nav-item" data-view="relays">üîå Relays</a></li>
                </ul>
            </nav>

            <!-- Content area where notes are displayed -->
            <section id="content">
                <!-- Feed view -->
                <div id="view-feed" class="view active">
                    <div class="view-header">
                        <h2>Your Feed</h2>
                        <div class="view-actions">
                            <button id="compose-btn" class="btn btn-primary">‚úèÔ∏è Compose</button>
                            <button id="refresh-btn" class="btn">üîÑ Refresh</button>
                        </div>
                    </div>
                    <div id="notes-container">
                        <!-- Notes will be inserted here by JavaScript -->
                        <div class="placeholder-message">
                            <p>Welcome to Plume!</p>
                            <p>Configure your keys in Settings to start browsing Nostr.</p>
                        </div>
                    </div>
                </div>

                <!-- Profile view -->
                <div id="view-profile" class="view">
                    <div class="view-header">
                        <h2>Your Profile</h2>
                        <button id="refresh-profile-btn" class="btn">üîÑ Fetch from Relays</button>
                    </div>
                    <div id="profile-container">
                        <div class="profile-card">
                            <div id="profile-banner" class="profile-banner"></div>
                            <div class="profile-avatar">
                                <img id="profile-picture" src="" alt="Profile" style="display: none;">
                                <div id="profile-placeholder" class="avatar-placeholder">?</div>
                            </div>
                            <div class="profile-info">
                                <h3 id="profile-name">Not configured</h3>
                                <p id="profile-nip05" class="nip05"></p>
                                <p id="profile-pubkey" class="pubkey">No public key set</p>
                                <p id="profile-about" class="profile-about"></p>
                                <div id="profile-links" class="profile-links">
                                    <a id="profile-website" href="#" target="_blank" rel="noopener" style="display: none;">üåê Website</a>
                                    <span id="profile-lightning" style="display: none;">‚ö° <span id="profile-lud16"></span></span>
                                </div>
                                <div id="no-key-notice" class="no-key-notice">
                                    <p>You don't have a Nostr identity yet.</p>
                                    <button id="generate-keys-btn" class="btn btn-primary" type="button">üîë Generate New Key Pair</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Following view -->
                <div id="view-following" class="view">
                    <div class="view-header">
                        <h2>Following & Followers</h2>
                        <button id="refresh-following-btn" class="btn">üîÑ Fetch</button>
                    </div>
                    <div id="following-container">
                        <!-- Stats summary -->
                        <div class="follow-stats">
                            <div class="stat-box">
                                <span class="stat-number" id="following-count">-</span>
                                <span class="stat-label">Following</span>
                            </div>
                            <div class="stat-box">
                                <span class="stat-number" id="followers-count">-</span>
                                <span class="stat-label">Followers</span>
                            </div>
                        </div>
                        
                        <!-- Tabs -->
                        <div class="follow-tabs">
                            <button class="follow-tab active" data-tab="following">Following</button>
                            <button class="follow-tab" data-tab="followers">Followers</button>
                        </div>
                        
                        <!-- Following list -->
                        <div id="following-list" class="follow-list active">
                            <div class="placeholder-message">
                                <p>Click Fetch to load your following list</p>
                            </div>
                        </div>
                        
                        <!-- Followers list -->
                        <div id="followers-list" class="follow-list">
                            <div class="placeholder-message">
                                <p>Click Fetch to load your followers</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Relays view -->
                <div id="view-relays" class="view">
                    <div class="view-header">
                        <h2>Relays</h2>
                        <button id="add-relay-btn" class="btn">+ Add Relay</button>
                    </div>
                    <div id="relays-container">
                        <ul id="relay-list">
                            <!-- Relay items will be inserted here -->
                        </ul>
                    </div>
                </div>
            </section>
        </main>

        <!-- Settings Modal -->
        <div id="settings-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>Settings</h2>
                    <button id="close-settings" class="close-btn">&times;</button>
                </div>
                <div class="modal-body">
                    <form id="settings-form">
                        <div class="form-group">
                            <label for="input-display-name">Display Name</label>
                            <input type="text" id="input-display-name" placeholder="Your display name">
                        </div>
                        <div class="form-group">
                            <label for="input-public-key">Public Key (npub or hex)</label>
                            <input type="text" id="input-public-key" placeholder="npub1... or 64-char hex">
                            <small class="form-hint">Your Nostr identity - accepts npub1... or hex format</small>
                            <span id="input-public-key-error" class="validation-error"></span>
                        </div>
                        <div class="form-group">
                            <label for="input-private-key">Private Key (nsec or hex) - Optional</label>
                            <input type="password" id="input-private-key" placeholder="nsec1... or hex (optional)">
                            <small class="form-hint">Only needed if you want to post notes</small>
                            <span id="input-private-key-error" class="validation-error"></span>
                        </div>
                        <div class="form-actions">
                            <button type="submit" class="btn btn-primary">Save Settings</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Compose Modal -->
        <div id="compose-modal" class="modal">
            <div class="modal-content modal-compose">
                <div class="modal-header">
                    <h2>Compose Note</h2>
                    <button id="close-compose" class="close-btn">&times;</button>
                </div>
                <div class="modal-body">
                    <form id="compose-form">
                        <div class="form-group">
                            <textarea 
                                id="compose-content" 
                                placeholder="What's on your mind?"
                                rows="6"
                                maxlength="10000"
                            ></textarea>
                            <div class="char-count">
                                <span id="char-count">0</span> / 10000
                            </div>
                        </div>
                        <div id="compose-error" class="compose-error"></div>
                        <div id="compose-status" class="compose-status"></div>
                        <div class="form-actions">
                            <button type="button" id="cancel-compose" class="btn">Cancel</button>
                            <button type="submit" id="submit-compose" class="btn btn-primary">
                                <span id="compose-btn-text">Post Note</span>
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>

